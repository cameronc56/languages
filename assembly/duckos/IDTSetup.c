extern unsigned int IDT_Contents;
extern unsigned int IDT_Pointer;

typedef struct IDT_Entry_s
{
	unsigned short HandlerPtr_Low;
	unsigned short Selector;
	unsigned char Reserved;
	unsigned char GateType		: 4;
	unsigned char StorageSegment: 1;
	unsigned char DPL			: 2;
	unsigned char Present		: 1;
	unsigned short HandlerPtr_High;
} IDT_Entry_t;

typedef struct IDT_Pointer_s
{
	unsigned short TableSize;
	IDT_Entry_t* IDT_Ptr;
} IDT_Pointer_t;


#define COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(i) \
{ \
	unsigned int HandlerPtr = (unsigned int)&CommonInterruptHandler##i;\
\
	IDT_Ptr[i].HandlerPtr_Low = (unsigned short)(HandlerPtr & 0x0000FFFF);\
	IDT_Ptr[i].HandlerPtr_High = (unsigned short)((HandlerPtr >> 16) & 0x0000FFFF);\
	IDT_Ptr[i].Selector = 0x8;\
	IDT_Ptr[i].Reserved = 0x0;\
	IDT_Ptr[i].GateType = 0xE;\
	IDT_Ptr[i].StorageSegment = 0x0;\
	IDT_Ptr[i].DPL = 0x0;\
	IDT_Ptr[i].Present = 0x1;\
}

void IDTSetupWrapper() {
	// BEGIN - Interrupt Descriptor Table setup

	IDT_Entry_t* IDT_Ptr = (IDT_Entry_t*)IDT_Contents;


	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(0)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(1)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(2)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(3)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(4)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(5)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(6)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(7)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(8)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(9)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(10)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(11)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(12)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(13)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(14)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(15)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(16)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(17)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(18)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(19)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(20)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(21)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(22)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(23)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(24)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(25)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(26)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(27)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(28)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(29)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(30)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(31)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(32)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(33)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(34)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(35)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(36)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(37)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(38)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(39)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(40)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(41)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(42)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(43)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(44)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(45)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(46)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(47)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(48)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(49)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(50)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(51)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(52)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(53)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(54)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(55)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(56)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(57)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(58)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(59)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(60)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(61)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(62)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(63)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(64)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(65)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(66)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(67)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(68)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(69)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(70)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(71)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(72)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(73)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(74)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(75)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(76)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(77)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(78)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(79)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(80)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(81)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(82)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(83)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(84)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(85)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(86)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(87)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(88)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(89)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(90)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(91)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(92)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(93)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(94)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(95)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(96)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(97)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(98)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(99)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(100)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(101)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(102)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(103)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(104)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(105)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(106)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(107)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(108)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(109)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(110)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(111)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(112)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(113)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(114)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(115)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(116)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(117)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(118)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(119)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(120)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(121)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(122)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(123)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(124)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(125)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(126)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(127)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(128)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(129)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(130)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(131)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(132)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(133)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(134)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(135)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(136)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(137)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(138)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(139)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(140)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(141)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(142)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(143)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(144)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(145)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(146)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(147)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(148)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(149)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(150)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(151)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(152)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(153)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(154)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(155)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(156)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(157)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(158)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(159)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(160)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(161)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(162)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(163)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(164)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(165)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(166)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(167)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(168)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(169)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(170)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(171)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(172)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(173)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(174)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(175)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(176)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(177)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(178)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(179)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(180)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(181)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(182)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(183)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(184)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(185)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(186)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(187)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(188)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(189)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(190)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(191)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(192)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(193)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(194)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(195)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(196)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(197)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(198)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(199)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(200)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(201)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(202)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(203)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(204)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(205)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(206)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(207)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(208)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(209)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(210)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(211)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(212)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(213)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(214)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(215)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(216)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(217)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(218)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(219)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(220)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(221)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(222)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(223)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(224)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(225)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(226)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(227)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(228)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(229)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(230)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(231)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(232)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(233)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(234)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(235)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(236)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(237)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(238)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(239)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(240)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(241)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(242)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(243)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(244)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(245)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(246)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(247)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(248)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(249)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(250)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(251)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(252)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(253)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(254)
	COMMON_INTERRUPT_HANDLER_SETUP_ENTRY(255)


	IDT_Pointer_t* IDT_Ptr_Ptr = (IDT_Pointer_t*)IDT_Pointer;
	IDT_Ptr_Ptr->TableSize = (unsigned short)((256 * sizeof(IDT_Entry_t)) - 1);
	IDT_Ptr_Ptr->IDT_Ptr = IDT_Ptr;

}